<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:th="http://www.thymeleaf.org"
    xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
    layout:decorate="~{layouts/main}">
<head>
<meta charset="UTF-8">
<title>Add IncomingProduct</title>
<script th:src="@{/js/incomingProduct.js}"></script>
</head>
<body>
<div layout:fragment="content">
<div class="row">
        <div class="col-md-3">
           <div class="box">
            <div class="box-header">
            
              <h3 class="box-title">Product Stock-In</h3>
            </div>
            <!-- /.box-header -->
            <div class="box-body">
            <form id="quickForm1"> 
              <div class="row">
             
               <div class="col-sm-12">
               <div class="form-group">
                  <label for="amount" class="col-sm-4 control-label">Supplier</label>
               
                  <div class="col-sm-8">
                    <select  id="supplier_id" name="supplier_id" class="form-control select1 select2-hidden-accessible" data-placeholder=" - - Select a Supplier - - " style="width: 100%;" data-select2-id="8" tabindex="-1" aria-hidden="true">
                 
                  <option value=""> - - Select a Supplier - - </option>
                    <option th:each="supplier : ${supplier}" th:value="${supplier.id}"
                            th:utext="${supplier.name}" />
                  </select>
                  </div>
                </div>
               </div>           
              </div>
              <br>
              <div class="row">
              <div class="col-sm-12">
               <div class="form-group">
                  <label for="amount" class="col-sm-4 control-label">P.O Number</label>

                  <div class="col-sm-8">
                    <input  class="form-control" name="purchase_number" id="purchase_number" />
                  </div>
                </div>
               </div>
              
              </div>
            <br>
              <div class="row">
              <div class="col-sm-12">
               <div class="form-group">
                  <label for="amount" class="col-sm-4 control-label">Total Price</label>

                  <div class="col-sm-8">
                    <input type="number" class="form-control" name="total_price" id="total_price" />
                  </div>
                </div>
               </div>
              
              </div>
              <br>
              <div class="row">
              <div class="col-sm-12">
               <div class="form-group">
                  <label for="amount" class="col-sm-4 control-label">Discount</label>

                  <div class="col-sm-8">
                    <input type="number" class="form-control" id="discount" />
                  </div>
                </div>
               </div>
              
              </div>
              <br>           
              <div class="row">
              <div class="col-sm-12">
               <div class="form-group">
                  <label for="amount" class="col-sm-4 control-label">Grand Total</label>

                  <div class="col-sm-8">
                    <input type="number" class="form-control" id="grandtotal" />
                  </div>
                </div>
               </div>
              
              </div>       
              <br>
              <div class="row">
              <div class="col-sm-12">
               <div class="form-group">
                  <label for="amount" class="col-sm-4 control-label">Purchase Date</label>

                  <div class="col-sm-8">
                    <input type="date"  class="form-control" name="purchase_date" id="purchase_date" />
                  </div>
                </div>
               </div>
              
              </div>
              <br>
              <div class="row">
              <div class="col-sm-12">
               <div class="form-group">
                  <label for="amount" class="col-sm-4 control-label">Purchase Note</label>

                  <div class="col-sm-8">
                    <input  class="form-control" id="purchase_note" />
                  </div>
                </div>
               </div>
              
              </div>
              <br>
              <div class="row">
              <div class="col-sm-12">
              <button onclick="productListSubmitToServer();" class="btn btn-info pull-right">Submit</button>
   
               </div>
              
              </div>
             
             </form>
          
          </div>
          <!-- /.box -->
        </div>
        </div>
        
                <div class="col-md-9">
                <div class="box">
           
            <!-- /.box-header -->
            <div class="box-body">
             <form id="quickForm">
                <div class="row">
          
                <div class="col-sm-3">
               <div class="form-group">
                  <label for="amount" class="col-sm-4 control-label">Product</label>
               
                  <div class="col-sm-8">
                   <select  id="product_id" name="product_id" class="form-control select2 select2-hidden-accessible" data-placeholder=" Please Select " style="width: 100%;" data-select2-id="7" tabindex="-1" aria-hidden="true" >
                  <option value=""> - - Select a Product - - </option>
                    <option th:each="product : ${product}" th:value="${product.id}"
                            th:utext="${product.productName}" />
                  </select>
                  </div>
                </div>
               </div>
               
                 <div class="col-sm-3">
               <div class="form-group">
                  <label for="amount" class="col-sm-6 control-label">Received Qty</label>

                  <div class="col-sm-6">
                    <input name="received_qty" type="number" class="form-control" id="received_qty" />
                  </div>
                </div>
               </div>
                <div class="col-sm-3">
               <div class="form-group">
                  <label for="amount" class="col-sm-6 control-label">Unit Price</label>

                  <div class="col-sm-6">
                    <input type="number" class="form-control" name="unit_price" id="unit_price" />
                  </div>
                </div>
               </div>
                 <div class="col-sm-3">
               <div class="form-group">
                  <label for="amount" class="col-sm-6 control-label">Total price</label>

                  <div class="col-sm-6">
                    <input type="number" class="form-control" name="purchase_price" id="purchase_price" />
                  </div>
                </div>
               </div>
              </div>
              <br>
               <div class="row" >
               <div class="col-sm-3">
               <div class="form-group">
                  <label for="amount" class="col-sm-4 control-label">Discount Type</label>

                  <div class="col-sm-8">
                     <select  id="discountType" name="discountType" class="form-control" >
                  <option value=""> Please Select </option>
                   <option value="Percent"> Percent(%)</option>
                    <option value="BDT"> BDT</option>
                   
                  </select>
                  </div>
                </div>
               </div>
                <div class="col-sm-3">
               <div class="form-group">
                  <label for="amount" class="col-sm-4 control-label">Discount</label>

                  <div class="col-sm-8">
                    <input type="number" class="form-control" id="discount1" />
                  </div>
                </div>
               </div>
             
                <div class="col-sm-4">
               <div class="form-group">
                  <label for="amount" class="col-sm-4 control-label"> Batch</label>

                  <div class="col-sm-6">
                  <select  id="productBatchId" name="productBatchId" class="form-control select2 select2-hidden-accessible" data-placeholder=" Please Select " style="width: 100%;" data-select2-id="9" tabindex="-1" aria-hidden="true">
                  <option value="">Select a Batch</option>
                    <option th:each="batch : ${productBatchList}" th:value="${batch.id}"
                            th:utext="${batch.batchNumber}" />
                  </select>
                  </div>
                </div>
               </div>
                 <div class="col-sm-2">
              <button  onclick="productUpdate();" class="btn btn-info pull-right">Add Product</button>
              </div>
               </div>
              <!-- /.box-body -->
         </form>
          
          </div>
          <!-- /.box -->
            
         <div class="row">
        <div class="col-sm-10">
            <h2>List Of Products</h2>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-12">
            <table id="productTable" class="table table-bordered table-condensed table-striped">
                <thead>
                    <tr>
                     <th hidden="true">Product Id</th>
                        <th>Product Name</th>
                        <th>Quantity</th>
                        <th>Unit Price</th>
                        <th>Total Price</th>
                        <th>Discount Type</th>
                        <th>Discount</th>
                        <th>Grand Total</th>
                        <th>Batch</th>
                        <th>#</th>
                    </tr>
                </thead>
            </table>
        </div>
    </div>
   
        </div>
        
        </div>
      
        </div>
    
</div>
<div layout:fragment="custom-scripts">
<script src="https://cdn.datatables.net/plug-ins/1.10.19/api/sum().js"></script>   
<script th:src="@{/js/incomingProduct.js}"></script>
<script th:inline="javascript">
/*<![CDATA[*/
var baseurl=/*[[${baseurl}]]*/;
$(document).ready(function() {
	$('.select2').select2();
	$('.select1').select2();
	setBaseUrl(baseurl);
	
});
$(function(){
    $("#purchase_price").click(function(){    	
    	$("#purchase_price").val($("#received_qty").val()*$("#unit_price").val())
    });
});

$(function(){
    $("#total_price").click(function(){ 
    	$("#total_price").val($('#productTable').DataTable().column(4).data().sum())
    });
});

$(function(){
    $("#discount").click(function(){ 
    	$("#discount").val($('#productTable').DataTable().column(6).data().sum())
    });
});

$(function(){
    $("#grandtotal").click(function(){ 
    	$("#grandtotal").val($('#productTable').DataTable().column(7).data().sum())
    });
});

/* $(function(){
    $("#productBatchId").click(function(){ 
    	alert($("#productBatchId").val())
    });
}); */

$(function () {

	  $('#quickForm').validate({
	    rules: {	    	
	    	received_qty: {
	        required: true
	      },
	      unit_price: {
	            required: true
	      },
          purchase_price: {
             required: true
           }
	      
	    },
	    messages: {
	    	received_qty: {
	        required: "Please enter a received_qty"
	      },
	      total_price: {
	            required: "Please enter a unit_price"
	      },
          purchase_price: {
             required: "Please enter a total_price"
          }
	      
	    },
	    errorElement: 'span',
	    errorPlacement: function (error, element) {
	      error.addClass('invalid-feedback');
	      element.closest('.form-group').append(error);
	    },
	    highlight: function (element, errorClass, validClass) {
	      $(element).addClass('is-invalid');
	    },
	    unhighlight: function (element, errorClass, validClass) {
	      $(element).removeClass('is-invalid');
	    }
	  });
	  
	   $('#quickForm1').validate({
	        rules: {            
	        	purchase_number: {
	            required: true
	          },
	          total_price: {
	                required: true
	          },
	          purchase_date: {
	             required: true
	           }
	          
	        },
	        messages: {
	        	purchase_number: {
	            required: "Please enter a purchase_number"
	          },
	          total_price: {
	                required: "Please enter a price"
	          },
	          purchase_date: {
	             required: "Please enter a purchase_date"
	          }
	          
	        },
	        errorElement: 'span',
	        errorPlacement: function (error, element) {
	          error.addClass('invalid-feedback');
	          element.closest('.form-group').append(error);
	        },
	        highlight: function (element, errorClass, validClass) {
	          $(element).addClass('is-invalid');
	        },
	        unhighlight: function (element, errorClass, validClass) {
	          $(element).removeClass('is-invalid');
	        }
	      });
	});
/*]]>*/
</script>
</div>
</body>
</html>